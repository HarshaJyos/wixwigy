"use strict";(self.webpackChunkcodox_lexical=self.webpackChunkcodox_lexical||[]).push([[41],{1041:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var o=n(5532),s=n(9837),r=n(4710),l=n(8268),i=n(5388),c=n(407),a=n(5043);const u=n(7890).q?a.useLayoutEffect:a.useEffect;var d=n(1099);const f={...n(5024).A,paragraph:"StickyEditorTheme__paragraph"};var p=n(2031),g=n(5138),h=n(9774),m=n(579);function v(e,t){const n=e.style,o=t.rootElementRect,s=null!==o?o.left:0,r=null!==o?o.top:0;n.top=r+t.y+"px",n.left=s+t.x+"px"}function x(e){let{x:t,y:n,nodeKey:x,color:y,caption:E}=e;const[k]=(0,o.DF)(),_=(0,a.useRef)(null),b=(0,a.useRef)({isDragging:!1,offsetX:0,offsetY:0,rootElementRect:null,x:0,y:0});(0,a.useEffect)(()=>{const e=b.current;e.x=t,e.y=n;const o=_.current;null!==o&&v(o,e)},[t,n]),u(()=>{const e=b.current,t=new ResizeObserver(t=>{for(let n=0;n<t.length;n++){const o=t[n],{target:s}=o;e.rootElementRect=s.getBoundingClientRect();const r=_.current;null!==r&&v(r,e)}}),n=k.registerRootListener((e,n)=>{null!==n&&t.unobserve(n),null!==e&&t.observe(e)}),o=()=>{const t=k.getRootElement(),n=_.current;null!==t&&null!==n&&(e.rootElementRect=t.getBoundingClientRect(),v(n,e))};return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o),n()}},[k]),(0,a.useEffect)(()=>{const e=_.current;null!==e&&setTimeout(()=>{e.style.setProperty("transition","top 0.3s ease 0s, left 0.3s ease 0s")},500)},[]);const w=e=>{const t=_.current,n=b.current,o=n.rootElementRect;null!==t&&n.isDragging&&null!==o&&(n.x=e.pageX-n.offsetX-o.left,n.y=e.pageY-n.offsetY-o.top,v(t,n))},L=e=>{const t=_.current,n=b.current;null!==t&&(n.isDragging=!1,t.classList.remove("dragging"),k.update(()=>{const e=(0,c.ns)(x);(0,h.oL)(e)&&e.setPosition(n.x,n.y)})),document.removeEventListener("pointermove",w),document.removeEventListener("pointerup",L)},{historyState:C}=(0,d.O)();return(0,m.jsx)("div",{ref:_,className:"sticky-note-container",children:(0,m.jsxs)("div",{className:`sticky-note ${y}`,onPointerDown:e=>{const t=_.current;if(null==t||2===e.button||e.target!==t.firstChild)return;const n=t,o=b.current;if(null!==n){const{top:t,left:s}=n.getBoundingClientRect();o.offsetX=e.clientX-s,o.offsetY=e.clientY-t,o.isDragging=!0,n.classList.add("dragging"),document.addEventListener("pointermove",w),document.addEventListener("pointerup",L),e.preventDefault()}},children:[(0,m.jsx)("button",{onClick:()=>{k.update(()=>{const e=(0,c.ns)(x);(0,h.oL)(e)&&e.remove()})},className:"delete","aria-label":"Delete sticky note",title:"Delete",children:"X"}),(0,m.jsx)("button",{onClick:()=>{k.update(()=>{const e=(0,c.ns)(x);(0,h.oL)(e)&&e.toggleColor()})},className:"color","aria-label":"Change sticky note color",title:"Color",children:(0,m.jsx)("i",{className:"bucket"})}),(0,m.jsxs)(l.s,{initialEditor:E,initialTheme:f,children:[(0,m.jsx)(r.G,{externalHistoryState:C}),(0,m.jsx)(i.h,{contentEditable:(0,m.jsx)(p.A,{className:"StickyNode__contentEditable"}),placeholder:(0,m.jsx)(g.A,{className:"StickyNode__placeholder",children:"What's up?"}),ErrorBoundary:s.LexicalErrorBoundary})]})]})})}},8268:(e,t,n)=>{n.d(t,{s:()=>u});var o=n(9593),s=n(5532),r=n(5043),l=n(579);var i,c=(i=function(e){const t=new URLSearchParams;t.append("code",e);for(let n=1;n<arguments.length;n++)t.append("v",arguments[n]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i;function a(e){const t=e.transform();return null!==t?new Set([t]):new Set}function u(e){let{initialEditor:t,children:n,initialNodes:i,initialTheme:u,skipCollabChecks:d}=e;const f=(0,r.useRef)(!1),p=(0,r.useContext)(s.Gu);null==p&&c(9);const[g,{getTheme:h}]=p,m=(0,r.useMemo)(()=>{const e=u||h()||void 0,n=(0,s.Mx)(p,e);if(void 0!==e&&(t._config.theme=e),t._parentEditor=g,i)for(let o of i){let e=null,n=null;if("function"!=typeof o){const t=o;o=t.replace,e=t.with,n=t.withKlass||null}const s=t._nodes.get(o.getType());t._nodes.set(o.getType(),{exportDOM:s?s.exportDOM:void 0,klass:o,replace:e,replaceWithKlass:n,transforms:a(o)})}else{const e=t._nodes=new Map(g._nodes);for(const[n,o]of e)t._nodes.set(n,{exportDOM:o.exportDOM,klass:o.klass,replace:o.replace,replaceWithKlass:o.replaceWithKlass,transforms:a(o.klass)})}return t._config.namespace=g._config.namespace,t._editable=g._editable,[t,n]},[]),{isCollabActive:v,yjsDocMap:x}=(0,o.k)(),y=d||f.current||x.has(t.getKey());return(0,r.useEffect)(()=>{y&&(f.current=!0)},[y]),(0,r.useEffect)(()=>g.registerEditableListener(e=>{t.setEditable(e)}),[t,g]),(0,l.jsx)(s.Gu.Provider,{value:m,children:!v||y?n:null})}}}]);
//# sourceMappingURL=41.fc0de238.chunk.js.map