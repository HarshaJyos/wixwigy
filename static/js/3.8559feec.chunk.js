"use strict";(self.webpackChunkcodox_lexical=self.webpackChunkcodox_lexical||[]).push([[3],{1003:(e,o,t)=>{t.r(o),t.d(o,{default:()=>_});var n=t(9593),l=t(5532),s=t(4736),i=t(8578),d=t(407),a=t(5043),c=t(2317),r=t(5593),p=t(8528),u=t(579);function h(e){let{option:o,index:t,options:l,totalVotes:s,withPollNode:i}=e;const{clientID:d}=(0,n.k)(),c=(0,a.useRef)(null),p=o.votes,h=-1!==p.indexOf(d),_=p.length,x=o.text;return(0,u.jsxs)("div",{className:"PollNode__optionContainer",children:[(0,u.jsx)("div",{className:(0,r.A)("PollNode__optionCheckboxWrapper",h&&"PollNode__optionCheckboxChecked"),children:(0,u.jsx)("input",{ref:c,className:"PollNode__optionCheckbox",type:"checkbox",onChange:e=>{i(e=>{e.toggleVote(o,d)})},checked:h})}),(0,u.jsxs)("div",{className:"PollNode__optionInputWrapper",children:[(0,u.jsx)("div",{className:"PollNode__optionInputVotes",style:{width:(0===_?0:_/s*100)+"%"}}),(0,u.jsx)("span",{className:"PollNode__optionInputVotesCount",children:_>0&&(1===_?"1 vote":`${_} votes`)}),(0,u.jsx)("input",{className:"PollNode__optionInput",type:"text",value:x,onChange:e=>{const t=e.target,n=t.value,l=t.selectionStart,s=t.selectionEnd;i(e=>{e.setOptionText(o,n)},()=>{t.selectionStart=l,t.selectionEnd=s})},placeholder:`Option ${t+1}`})]}),(0,u.jsx)("button",{disabled:l.length<3,className:(0,r.A)("PollNode__optionDelete",l.length<3&&"PollNode__optionDeleteDisabled"),"aria-label":"Remove",onClick:()=>{i(e=>{e.deleteOption(o)})}})]})}function _(e){let{question:o,options:t,nodeKey:n}=e;const[r]=(0,l.DF)(),_=(0,a.useMemo)(()=>function(e){return e.reduce((e,o)=>e+o.votes.length,0)}(t),[t]),[x,N,m]=(0,s.Y)(n),[v,f]=(0,a.useState)(null),C=(0,a.useRef)(null),g=(0,a.useCallback)(e=>{if(x&&(0,d.RT)((0,d.vJ)())){e.preventDefault();const o=(0,d.ns)(n);(0,p.q9)(o)&&o.remove()}return!1},[x,n]);(0,a.useEffect)(()=>(0,i.Sd)(r.registerUpdateListener(e=>{let{editorState:o}=e;f(o.read(()=>(0,d.vJ)()))}),r.registerCommand(d.d8,e=>{const o=e;return o.target===C.current&&(o.shiftKey||m(),N(!x),!0)},d.Ac),r.registerCommand(d.w$,g,d.Ac),r.registerCommand(d.gC,g,d.Ac)),[m,r,x,n,g,N]);const P=(e,o)=>{r.update(()=>{const o=(0,d.ns)(n);(0,p.q9)(o)&&e(o)},{onUpdate:o})},j=(0,d.RT)(v)&&x;return(0,u.jsx)("div",{className:"PollNode__container "+(j?"focused":""),ref:C,children:(0,u.jsxs)("div",{className:"PollNode__inner",children:[(0,u.jsx)("h2",{className:"PollNode__heading",children:o}),t.map((e,o)=>{const n=e.uid;return(0,u.jsx)(h,{withPollNode:P,option:e,index:o,options:t,totalVotes:_},n)}),(0,u.jsx)("div",{className:"PollNode__footer",children:(0,u.jsx)(c.A,{onClick:()=>{P(e=>{e.addOption((0,p.hw)())})},small:!0,children:"Add Option"})})]})})}}}]);
//# sourceMappingURL=3.8559feec.chunk.js.map